{% import "image_common.svg" as image_common %}
<svg version="1.1" width="355" height="340" xmlns="http://www.w3.org/2000/svg">
     <style>
          :root { font-family: 'Noto Sans', sans-serif; }
          text { fill: {{ foreground_color or '#F8F9FA' }}; }
          #last-seen { font-size: 12px; }
          #username { font-size: 32px; font-weight: bold; }
          #pronouns { font-size: 12.8px; font-weight: bold; }
          #status { font-size: 19.2px; font-weight: bold; }
     </style>

     <defs>
          <mask id="banner-mask">
               <rect x="0" y="0" width="355" height="8" fill="black"/>
               <rect rx="8" ry="8" width="355" height="215" fill="white"/>
               <rect x="0" y="207" width="355" height="8" fill="white"/>
          </mask>

          <mask id="pfp-mask">
               <circle cx="57" cy="158" r="43" radius="90" fill="white"/>
          </mask>

          <filter id="pfp-shadow">
               <feDropShadow dx="0" dy="4" stdDeviation="2" flood-color="rgba(10, 10, 13, 0.55)" />
          </filter>

          <filter x="0" y="0" width="1" height="1" id="last-seen-bg-filter">
               <feFlood flood-color="rgba(17, 17, 17, 0.8)"/>
               <feComposite in="SourceGraphic" operator="xor"/>
          </filter>
     </defs>

     <rect x="0" y="0" width="355" height="340" rx="8" ry="8" fill="{{ background_color or '#181B1F' }}"/>

     <image id="banner-img" x="0" y="0" width="355" height="215" href="{{ banner_url or user.profile_pic_override_thumbnail or user.current_avatar_thumbnail_image_url }}" mask="url(#banner-mask)" preserveAspectRatio="xMidYMid slice"/>

     {%- if pfp_url or user.user_icon -%}
     {%- if user.state == "online" -%}
          {% set pfp_bg_color = "rgb(81, 229, 126)" %}
     {%- else -%}
          {% set pfp_bg_color = "rgb(128, 128, 128)" %}
     {%- endif -%}
     <circle id="pfp-bg" cx="57" cy="158" r="45" fill="{{ pfp_bg_color }}" filter="url(#pfp-shadow)"/>
     <image id="pfp-img" x="14" y="115" width="86" height="86" href="{{pfp_url or user.user_icon }}" mask="url(#pfp-mask)"/>
     {%- endif -%}

     <rect id="last-seen-bg" fill="rgba(17, 17, 17, 0.8)" x="{{ 355 - 12 - 4 - 8 - text_width(last_seen_str, 'Noto Sans', 12) - 18 }}" y="12" width="{{ text_width(last_seen_str, 'Noto Sans', 12) + 18 + 8 + 4}}" height="24" rx="12"/>
     <svg x="{{ 355 - 12 - 4 - text_width(last_seen_str, 'Noto Sans', 12) - 18 }}" y="18" width="10" height="12" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="{{ foreground_color or '#F8F9FA' }}" d="M176 0c-17.7 0-32 14.3-32 32s14.3 32 32 32l16 0 0 34.4C92.3 113.8 16 200 16 304c0 114.9 93.1 208 208 208s208-93.1 208-208c0-41.8-12.3-80.7-33.5-113.2l24.1-24.1c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L355.7 143c-28.1-23-62.2-38.8-99.7-44.6L256 64l16 0c17.7 0 32-14.3 32-32s-14.3-32-32-32L224 0 176 0zm72 192l0 128c0 13.3-10.7 24-24 24s-24-10.7-24-24l0-128c0-13.3 10.7-24 24-24s24 10.7 24 24z"></path></svg>
     <text id="last-seen" x="{{ 355 - 12 - 8 - text_width(last_seen_str, 'Noto Sans', 12) }}" y="23.5" dominant-baseline="central">{{last_seen_str}}</text>

     <text id="username" x="20" y="245" dominant-baseline="central">{{ user.display_name or user.username }}</text>
     <text id="pronouns" x="20" dy="280">{{ user.pronouns }}</text>

     {{ image_common.status_indicator(27.5, 311.5, user, ingame_only) }}

     <text id="status" x="42" y="310" dominant-baseline="central">{{ image_common.status_description(user) }}</text>

     {%- if logo_type == "big" -%}{{ image_common.vrc_logo_big(355 - 100 - 8, 340 - 40 - 6, 100, 40) }}
     {%- elif logo_type == "small" -%}{{ image_common.vrc_logo_small(355-40-8, 340-40-6, 40, 40) }}
     {%- endif -%}
</svg>
